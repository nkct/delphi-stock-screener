declare each assert as a subtest

enchance function definitions

in put allow for updating multiple rowsa at a time