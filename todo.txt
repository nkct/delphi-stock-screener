rewrite tests to be more concise and in the following format:
assert (
    function(test data),
    expected result
)

declare each assert as a subtest

normalize db cursor naming (cursor or cur)

enchance function definitions

change function call logging to debug

add sql query printout for debugging

clean up imports (src. is not nessecarily needed)